# üí≥ WalletSolution ‚Äî Demo Wallet (Case Study)

**Purpose:** a small, focused demo implementing a simplified Digital Wallet as requested in the case study.  
This project demonstrates full-stack capability: backend API design, database modeling, and a professional frontend.

**Implements**
- View wallet balance
- Earn points (credit)
- Burn points (debit)
- View transaction history (ordered by `CreatedAt`)

> **Note:** this is a demo app for the case study. There is **no full user management system** ‚Äî the wallet is addressed by a GUID (used purely for demo/test purposes). This keeps the scope aligned with the brief.

---

## üîß Tech stack

- **Backend:** .NET 8 (ASP.NET Core Web API)
- **Data access:** Entity Framework Core (primary). Optional Dapper demo included for pessimistic locking scenarios.
- **Frontend:** React + Vite + TypeScript
- **UI:** Material UI (MUI) + MUI DataGrid
- **HTTP client:** Axios
- **Docs / Testing:** Swagger (auto-generated by the API)

---

## üìÅ Project layout (high level)

```
/WalletSolution
  /src
    /Wallet.Core           # Domain entities & core logic (Wallet, WalletTransaction)
    /Wallet.Application    # Application services / DTOs / interfaces (IWalletService, etc.)
    /Wallet.Infrastructure # EF Core DbContext, repositories, optional Dapper bits
    /Wallet.Api            # ASP.NET Core Web API (controllers, DI, swagger)
  /web
    /wallet-frontend       # Vite + React frontend (pages, components, api wrapper)
```

---

## üîå API Endpoints (used by frontend)

All endpoints are under `/api/wallets`.

- `GET  /api/wallets/{userId}/balance`  
  Returns: `{ "userId": "...", "balance": 1200 }`

- `POST /api/wallets/{userId}/earn`  
  Body: `{ "amount": 50, "externalReference": "optional", "description": "optional" }`  
  Returns: `{ "userId": "...", "balance": 1250 }`

- `POST /api/wallets/{userId}/burn`  
  Body: `{ "amount": 50, "externalReference": "optional", "description": "optional" }`  
  Returns: `{ "userId": "...", "balance": 1200 }`

- `GET  /api/wallets/{userId}/transactions?skip=0&take=20`  
  Returns: `{ "items": [ { id, type, amount, balanceAfter, description, externalReference, createdAt } ], "total": 3 }`

> These shapes are what the React frontend expects. Controllers return `balance` as a number (not a nested DTO).

---

## ‚ñ∂Ô∏è Run locally (quick)

### Backend
1. Open solution in Visual Studio or use CLI.
2. Update connection string in `src/Wallet.Api/appsettings.Development.json` if needed.
3. Run EF Migrations (if applicable):
   ```bash
   dotnet ef database update --project src/Wallet.Infrastructure
   ```
4. Start API:
   ```bash
   dotnet run --project src/Wallet.Api
   ```
5. Swagger UI: `https://localhost:<port>/swagger`

### Frontend
1. From `web/wallet-frontend`:
   ```bash
   npm install
   npm run dev
   ```
2. Open `http://localhost:5173` (or Vite URL shown in terminal).

---

## ‚úÖ Design decisions & short rationale

- **No user table:** The case study asks for wallet operations by ID for demo purposes ‚Äî adding a full user management system would be out-of-scope.
- **Separation of concerns:** Clean architecture (Core/Application/Infrastructure/Api) isolates business logic and makes testing easier.
- **Idempotency:** `externalReference` is supported to avoid duplicate processing on retries.
- **Concurrency:** Default approach is optimistic concurrency with `RowVersion` + retry loop; a Dapper example demonstrates pessimistic locking (for high-contention scenarios).
- **Frontend:** MUI + DataGrid provides a professional, interview-ready UI quickly.

---

## üß™ Testing & demo tips for the interview

- Prepare one demo GUID (or add a seed endpoint) and note it in the README so interviewers can run the demo without data entry.
- Use Swagger to show the API contract and test endpoints manually during discussion.
- Demonstrate:
  1. Load wallet (GET balance)
  2. Earn points (POST earn) ‚Äî show balance update
  3. Burn points (POST burn) ‚Äî show balance update and error on insufficient balance
  4. Show transactions page sorted by `CreatedAt` (newest first)

---

## üìù Notes for the reviewer / grader

- Project focuses on the requested scope: wallet balance and transactions, API design, and a professional frontend.
- The repository includes examples for both EF Core and a Dapper snippet (pessimistic locking) to show breadth of backend skills.
- No production authentication is included ‚Äî the demo uses GUIDs to identify wallets for simplicity and to stay on-scope.

---

## üë®‚Äçüíª Author

**Ahmed Ramadan** ‚Äî Software engineer (full-stack demo).

---

## üìú License

MIT
